<html>
    <head>
        <!--<script src="./two/two.js"></script>-->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/two.js/0.6.0/two.js"></script>
        <script src="./tree.js"></script>
        <script src="./weather.js"></script>
        <script src="./functions.js"></script>
    </head>
    <body>
        <div id="draw-shapes"></div>
        <script>

            // Make an instance of two and place it on the page.
            var elem = document.getElementById('draw-shapes');
            var params = { width: '100%', height: '100%' , fullscreen: true, autostart: true};
            var two = new Two(params).appendTo(elem);

            var treeCenterX = 150;
            var treeCenterY = 150

            var trunk = two.makeRoundedRectangle(treeCenterX, treeCenterY, 10, 10, 2);
            // The object returned has many stylable properties:
            trunk.fill = '#694b37';
            trunk.stroke = '#694b37'; // Accepts all valid css color
            trunk.linewidth = 10;
            trunk.opacity = 1;     
            var trunkBase = two.makeRoundedRectangle(treeCenterX, treeCenterY, 11, 11, 2);
            trunkBase.fill = '#50392a';
            trunkBase.stroke = '#50392a'; // Accepts all valid css color
            trunkBase.linewidth = 10;

            var trunk1 = two.makeRoundedRectangle(treeCenterX, treeCenterY, 11, 11, 2);
            trunk1.fill = '#50392a';
            trunk1.stroke = '#50392a'; // Accepts all valid css color
            trunk1.linewidth = 10;

            var treeGroup = new Two.Group(); 
            var treeGroup1 = new Two.Group();
            var treeGroup2 = new Two.Group();
            two.add(treeGroup);
            two.add(treeGroup1);
            two.add(treeGroup2);
            
            treeGroup1.add(trunk1)
            treeGroup2.add(trunk);
            
            var treeArray = [treeGroup, treeGroup1, treeGroup2, 0.56];

            var floraArray = [treeArray];
            for (const element of treeArray) {
                console.log(element);
            }
            
            //Adding leaves onto the tree

            for(var i =0; i< smallTree.numLeaves; i++)
            {
                //variation in leaf size from the pre set values
                var leafSize = ((Math.random()*smallTree.averageLeafSize));
                var leafSize = randomBetween(smallTree.averageLeafSize/4,smallTree.averageLeafSize)
                                        //Centre of Tree + random variation   , Same again                          , 

                //Big leaves are closer, at an angle and a distance from the center, smaller leaves at the edges
                var circ = two.makeCircle(treeCenterX+(randomBetween(0,smallTree.maxRadius)-smallTree.maxRadius/2), treeCenterY+(randomBetween(0,smallTree.maxRadius)-smallTree.maxRadius/2), leafSize);
                circ.fill = '#71b637';
                circ.stroke = '#478a0b'; // Accepts all valid css color
                circ.linewidth = 3;
                circ.opacity = smallTree.leafOpacity;
                treeGroup.add(circ);
            }
            //Drawing red box around the outer tree
           /* console.log(treeGroup.getBoundingClientRect(false));
            var boundBox = two.makeRectangle((treeGroup.getBoundingClientRect(false).left+treeGroup.getBoundingClientRect(false).right)/2,(treeGroup.getBoundingClientRect(false).top + treeGroup.getBoundingClientRect(false).bottom)/2,treeGroup.getBoundingClientRect(false).width,treeGroup.getBoundingClientRect(false).height,2);
            boundBox.noFill();
            boundBox.stroke = 'red';
            treeGroup.add(boundBox);*/

            

            for(var i =0; i< smallTree.numLeaves/3; i++)
            {
                //variation in leaf size from the pre set values
                var leafSize = ((Math.random()*smallTree.averageLeafSize))
                                        //Centre of Tree + random variation   , Same again                          , 

                //Big leaves are closer, at an angle and a distance from the center, smaller leaves at the edges
                var circ = two.makeCircle(treeCenterX+(randomBetween(0,smallTree.maxRadius/1.5)-smallTree.maxRadius/3), treeCenterY+(randomBetween(0,smallTree.maxRadius/1.5)-smallTree.maxRadius/3), leafSize/1.5);
                circ.fill = '#71b637';
                circ.stroke = '#478a0b'; // Accepts all valid css color
                circ.linewidth = 3;
                circ.opacity = parseFloat(smallTree.leafOpacity,10)+0.1;
                treeGroup1.add(circ);
            }
            console.log(parseFloat(smallTree.leafOpacity,10)+0.1)

            //Drawing red box around the outer tree
           /* console.log(treeGroup1.getBoundingClientRect(false));
            var boundBox1 = two.makeRectangle((treeGroup1.getBoundingClientRect(false).left+treeGroup1.getBoundingClientRect(false).right)/2,(treeGroup1.getBoundingClientRect(false).top + treeGroup1.getBoundingClientRect(false).bottom)/2,treeGroup1.getBoundingClientRect(false).width,treeGroup1.getBoundingClientRect(false).height,2);
            boundBox1.noFill();
            boundBox1.stroke = 'red';
            treeGroup1.add(boundBox1);*/

            for(var i =0; i< smallTree.numLeaves/3; i++)
            {
                //variation in leaf size from the pre set values
                var leafSize = ((Math.random()*smallTree.averageLeafSize))
                                        //Centre of Tree + random variation   , Same again                          , 

                //Big leaves are closer, at an angle and a distance from the center, smaller leaves at the edges
                var circ = two.makeCircle(treeCenterX+(randomBetween(0,smallTree.maxRadius/4)-smallTree.maxRadius/8), treeCenterY+(randomBetween(0,smallTree.maxRadius/4)-smallTree.maxRadius/8), leafSize/3);
                circ.fill = '#71b637';
                circ.stroke = '#478a0b'; // Accepts all valid css color
                circ.linewidth = 3;
                circ.opacity = parseFloat(smallTree.leafOpacity,10)+0.2;
                treeGroup2.add(circ);
            }
            
            //Drawing red box around the outer tree
           /* console.log(treeGroup2.getBoundingClientRect(false));
            var boundBox2 = two.makeRectangle((treeGroup2.getBoundingClientRect(false).left+treeGroup2.getBoundingClientRect(false).right)/2,(treeGroup2.getBoundingClientRect(false).top + treeGroup2.getBoundingClientRect(false).bottom)/2,treeGroup2.getBoundingClientRect(false).width,treeGroup2.getBoundingClientRect(false).height,2);
            boundBox2.noFill();
            boundBox2.stroke = 'red';
            treeGroup2.add(boundBox2);*/

           
            treeArray[1].translation.set(500,500);

            // Don't forget to tell two to render everything
            // to the screen
            //
            treeGroup.translation.set(0, 0);
            //var circ = two.makeCircle(treeCenterX, treeCenterY, 5);
            //circ.fill ='red';
            two.update();
            //Removed Math.Abs to make more natural movement
            two.bind('update', function(frameCount, timeDelta) {
                //                                                    speed, amplitude
                var sinOfTime = Math.sin(frameCount/100);
                for(var j = 0; j < treeArray.length-1; j++)
                {

                    treeArray[j].translation.set(((sinOfTime*wind.eastWestSpeed*(j+1))-(j)), ((sinOfTime*wind.northSouthSpeed*(j+1))-(j)));
                    //treeGroup1.translation.set(((sinOfTime*(wind.eastWestSpeed*1.5)+0.0)-2), ((sinOfTime*(wind.northSouthSpeed*1.5)+0.0)));
                    //treeGroup2.translation.set(((sinOfTime*(wind.eastWestSpeed*2)+0.0)-4), ((sinOfTime*(wind.northSouthSpeed*2))+0.0));
                }
            });
            
        </script>
        

        </div>
    </body>
</html>
